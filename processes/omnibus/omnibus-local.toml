# Top-level configuration for Acropolis omnibus process

[global.startup]
network-name = "preview" # "sanchonet", "preview", "mainnet"
topic = "cardano.sequence.start"

[module.genesis-bootstrapper]

#[module.mithril-snapshot-fetcher]
#aggregator-url = "https://aggregator.pre-release-preview.api.mithril.network/aggregator"
#genesis-key = "5b3132372c37332c3132342c3136312c362c3133372c3133312c3231332c3230372c3131372c3139382c38352c3137362c3139392c3136322c3234312c36382c3132332c3131392c3134352c31332c3233322c3234332c34392c3232392c322c3234392c3230352c3230352c33392c3233352c34345d"
#download = false

[module.rest-blockfrost]

[module.peer-network-interface]
sync-point = "origin" #"cache" # "origin", "tip", "snapshot"
node-addresses = [
    "localhost:3001",
    "localhost:3002",
    "localhost:3003",
]
magic-number = 2

[module.midnight-state]
enable-indexer = false
address-deltas-topic = "cardano.address.deltas"

[module.block-unpacker]

[module.tx-unpacker]
publish-utxo-deltas-topic = "cardano.utxo.deltas"
publish-withdrawals-topic = "cardano.withdrawals"
publish-certificates-topic = "cardano.certificates"
publish-governance-topic = "cardano.governance"
publish-block-txs-topic = "cardano.block.txs"

[module.consensus]

[module.utxo-state]
store = "memory" # "memory", "dashmap", "fjall", "fjall-async", "sled", "sled-async", "fake"
address-delta-topic = "cardano.address.deltas"

[module.spo-state]
# Enables /pools/{pool_id}/history endpoint, enables to query active_stakes
store-epochs-history = false
# Enable /pools/retired
store-retired-pools = false
# Enables /pools/{pool_id} endpoint
store-registration = false
# # Enables /pools/{pool_id}/updates endpoint
store-updates = false
# Enables /pools/{pool_id}/delegators endpoint (Requires store-stake-addresses to be enabled)
store-delegators = false
# Enables /pools/{pool_id}/votes endpoint
store-votes = false
# Store stake_addresses
store-stake-addresses = false

[module.drep-state]

[module.governance-state]

[module.parameters-state]
store-history = false

[module.stake-delta-filter]
cache-mode = "write" # "predefined", "read", "write", "write-if-absent"
write-full-cache = "false"

[module.epochs-state]
# Enables /epochs/{number} endpoint (for historical epochs)
store-history = false
# Enables /pools/{pool_id}/blocks endpoint
store-block-hashes = false


[module.accounts-state]

[module.clock]

[module.rest-server]
address = "127.0.0.1"
port = 4340

[module.mcp-server]
# MCP server configuration - runs on HTTP with Streamable HTTP transport
# AI clients can connect to http://<address>:<port>/mcp
enabled = true
address = "0.0.0.0"
port = 4341

[module.spy]
# Enable for message spying
#topic = "cardano.drep.state"

[message-bus.external]
class = "rabbit-mq"
url = "amqp://127.0.0.1:5672/%2f"
exchange = "caryatid"

[message-bus.internal]
class = "in-memory"
workers = 50
dispatch-queue-size = 1000
worker-queue-size = 100
bulk-block-capacity = 50
bulk-resume-capacity = 75

# Message routing
[[message-router.route]]  # Everything is internal only
pattern = "#"
bus = "internal"
