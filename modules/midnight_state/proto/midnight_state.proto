// NOTE:
// This proto definition is intended to be moved into a separate package/crate
// in the future. The goal is to publish it as a reusable dependency so that
// external clients can import and depend on the shared API contract directly.
syntax = "proto3";

package midnight_state;

service MidnightState {
  rpc GetAssetCreates (AssetCreatesRequest) returns (AssetCreatesResponse);
  rpc GetAssetSpends (AssetSpendsRequest) returns (AssetSpendsResponse);
  rpc GetRegistrations (RegistrationsRequest) returns (RegistrationsResponse);
  rpc GetDeregistrations (DeregistrationsRequest) returns (DeregistrationsResponse);
  rpc GetTechnicalCommitteeDatum (TechnicalCommitteeDatumRequest) returns (TechnicalCommitteeDatumResponse);
  rpc GetCouncilDatum (CouncilDatumRequest) returns (CouncilDatumResponse);
  rpc GetAriadneParameters (AriadneParametersRequest) returns (AriadneParametersResponse);
}

message AssetCreatesRequest {
  uint64 start_block = 1;
  uint64 end_block = 2;
}
message AssetCreate {
  bytes address = 1;
  uint64 quantity = 2;

  bytes tx_hash = 3;
  uint32 output_index = 4;

  uint64 block_number = 5;
  bytes block_hash = 6;
  uint32 tx_index = 7;

  int64 block_timestamp_unix = 8;
}
message AssetCreatesResponse {
  repeated AssetCreate creates = 1;
}

message AssetSpendsRequest {
  uint64 start_block = 1;
  uint64 end_block = 2;
}
message AssetSpend {
  bytes address = 1;
  uint64 quantity = 2;

  bytes spending_tx_hash = 3;
  uint64 block_number = 4;
  bytes block_hash = 5;
  uint32 tx_index = 6;

  bytes utxo_tx_hash = 7;
  uint32 utxo_index = 8;

  int64 block_timestamp_unix = 9;
}
message AssetSpendsResponse {
  repeated AssetSpend spends = 1;
}

message Datum {
  oneof value {
    bytes inline = 1;
    bytes hash = 2;
  }
}

message RegistrationsRequest {}
message RegistrationsResponse {}

message DeregistrationsRequest {}
message DeregistrationsResponse {}

message TechnicalCommitteeDatumRequest {
  uint64 block_number = 1;
}
message TechnicalCommitteeDatumResponse {
  uint64 source_block_number = 1;
  Datum datum = 2;
}

message CouncilDatumRequest {
  uint64 block_number = 1;
}
message CouncilDatumResponse {
  uint64 source_block_number = 1;
  Datum datum = 2;
}

message AriadneParametersRequest {}
message AriadneParametersResponse {}
